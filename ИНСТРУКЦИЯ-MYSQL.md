# Подробная инструкция по установке и настройке MySQL

## Установка MySQL на Windows

### Шаг 1: Загрузка установщика

1. Перейдите на официальный сайт MySQL: https://dev.mysql.com/downloads/installer/
2. Скачайте "MySQL Installer" для Windows (рекомендуется версия "Windows (x86, 32-bit), MSI Installer")
3. Для быстрого скачивания можно нажать на ссылку "No thanks, just start my download"

### Шаг 2: Запуск установщика

1. Запустите скачанный файл (например, `mysql-installer-community-8.0.xx.msi`)
2. Выберите тип установки:
   - **Developer Default** - для разработчиков (включает MySQL Server, MySQL Workbench и другие инструменты)
   - **Server only** - только сервер MySQL (минимальная установка)
3. Рекомендуется выбрать "Server only", если вы не планируете разрабатывать с использованием MySQL

### Шаг 3: Настройка сервера

1. На странице "Type and Networking":
   - Выберите "Standalone MySQL Server / Classic MySQL Replication"
   - Порт: оставьте стандартный 3306
   - Убедитесь, что отмечена опция "Open Windows Firewall ports for network access"

2. На странице "Authentication Method":
   - Рекомендуется выбрать "Use Strong Password Encryption"

3. На странице "Accounts and Roles":
   - Установите пароль для пользователя root (запомните или запишите его!)
   - При желании можно создать дополнительных пользователей (не обязательно)

4. На странице "Windows Service":
   - Оставьте имя службы по умолчанию: MySQL80
   - Отметьте "Start the MySQL Server at System Startup"
   - Рекомендуется оставить "Standard System Account"

5. Завершите установку, нажав "Execute" на странице "Apply Configuration"

### Шаг 4: Проверка установки

1. Откройте командную строку (cmd) или PowerShell
2. Выполните команду: `mysql --version`
3. Вы должны увидеть информацию о версии MySQL

## Создание пользователя и базы данных

### Создание пользователя

1. Откройте командную строку и войдите в MySQL:
   ```
   mysql -u root -p
   ```

2. Введите пароль root, установленный при установке

3. Создайте пользователя gameuser:
   ```sql
   CREATE USER 'gameuser'@'localhost' IDENTIFIED BY 'gameuser';
   ```

4. Предоставьте необходимые права пользователю:
   ```sql
   GRANT ALL PRIVILEGES ON *.* TO 'gameuser'@'localhost';
   FLUSH PRIVILEGES;
   ```

5. Выйдите из MySQL:
   ```sql
   EXIT;
   ```

### Создание базы данных

1. Войдите в MySQL под пользователем gameuser:
   ```
   mysql -u gameuser -pgameuser
   ```

2. Создайте базу данных:
   ```sql
   CREATE DATABASE gamedb;
   ```

3. Проверьте, что база данных создана:
   ```sql
   SHOW DATABASES;
   ```

4. Выберите базу данных для использования:
   ```sql
   USE gamedb;
   ```

## Настройка приложения для работы с MySQL

В файле `.env` установите следующие параметры:

```
DB_TYPE=mysql
DB_HOST=localhost
DB_USER=gameuser
DB_PASSWORD=gameuser
DB_DATABASE=gamedb
DB_PORT=3306
```

## Частые проблемы и их решение

### MySQL сервер не запускается

1. Откройте "Службы" (services.msc)
2. Найдите службу "MySQL80"
3. Проверьте статус и запустите службу, если она остановлена
4. Если служба не запускается, проверьте журналы ошибок в папке данных MySQL

### Не удается подключиться к MySQL

1. Убедитесь, что MySQL сервер запущен
2. Проверьте правильность имени пользователя и пароля
3. Проверьте, открыт ли порт 3306 в брандмауэре
4. Проверьте, что пользователь имеет права доступа с указанного хоста

### Ошибка "Access denied"

1. Проверьте правильность пароля
2. Убедитесь, что пользователь имеет необходимые права
3. Проверьте, с какого хоста разрешен доступ пользователю

### Проблемы с кодировкой

Если вы видите некорректные символы в данных, убедитесь, что в MySQL настроена кодировка UTF-8:

```sql
ALTER DATABASE gamedb CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

## Полезные команды MySQL

```sql
-- Показать все базы данных
SHOW DATABASES;

-- Показать все таблицы в текущей базе данных
SHOW TABLES;

-- Показать структуру таблицы
DESCRIBE имя_таблицы;

-- Создать резервную копию базы данных (выполняется в командной строке, не в MySQL)
mysqldump -u gameuser -pgameuser gamedb > backup.sql

-- Восстановить базу данных из резервной копии (выполняется в командной строке)
mysql -u gameuser -pgameuser gamedb < backup.sql
```

## Шаг 1: Установка MySQL

Поскольку Docker не установлен на вашей системе, вам необходимо установить MySQL напрямую:

1. Скачайте MySQL Installer с официального сайта: https://dev.mysql.com/downloads/installer/
2. Запустите установщик и выберите "Custom" установку
3. Выберите MySQL Server и MySQL Workbench (графический интерфейс для управления базой данных)
4. Нажмите "Next" и следуйте инструкциям установщика
5. Когда дойдете до настройки пароля root пользователя, установите пароль `yourpassword`
6. Завершите установку

## Шаг 2: Настройка MySQL

После установки MySQL, настройте базу данных и пользователя:

1. Откройте MySQL Workbench
2. Подключитесь к серверу MySQL, используя учетную запись root
3. Создайте новую базу данных и пользователя, выполнив следующие команды:

```sql
CREATE DATABASE game_catalog;
CREATE USER 'gameuser'@'localhost' IDENTIFIED BY 'gamepassword';
GRANT ALL PRIVILEGES ON game_catalog.* TO 'gameuser'@'localhost';
FLUSH PRIVILEGES;
```

## Шаг 3: Перенос данных с SQLite на MySQL

1. Убедитесь, что ваше приложение не запущено
2. Запустите команду миграции:

```bash
npm run migrate-to-mysql
```

Если миграция завершится успешно, вы увидите сообщение об успешном переносе данных.

## Шаг 4: Переключение на MySQL

1. Откройте файл `.env` и измените параметр:

```
DB_TYPE=mysql
```

2. Запустите приложение:

```bash
npm start
```

## Возможные проблемы

### Ошибка подключения к MySQL

Если вы видите ошибку подключения к MySQL:

1. Убедитесь, что сервер MySQL запущен
   - Проверьте в Диспетчере задач, что процесс "mysqld.exe" активен
   - Или в службах Windows (services.msc) проверьте, что служба MySQL запущена

2. Проверьте настройки подключения в файле `.env`
   - Убедитесь, что имя пользователя и пароль верны

3. Проверьте, что база данных создана:
   - Откройте MySQL Workbench
   - Подключитесь к серверу
   - Убедитесь, что база данных "game_catalog" существует

### Ошибка переноса данных

Если возникли проблемы при переносе данных:

1. Проверьте, что в файле SQLite есть данные:
   - Скачайте и установите DB Browser for SQLite: https://sqlitebrowser.org/
   - Откройте файл database.sqlite и проверьте содержимое таблиц

2. Если миграция не удалась, очистите базу данных MySQL и попробуйте снова:

```sql
DROP DATABASE game_catalog;
CREATE DATABASE game_catalog;
```

### Автоматический откат на SQLite

Приложение автоматически вернется к использованию SQLite, если MySQL недоступен. Если это происходит:

1. В консоли вы увидите сообщение "Переключаемся на SQLite..."
2. Проверьте, что сервер MySQL запущен и доступен
3. Проверьте настройки подключения

## Переключение между базами данных

Вы можете в любой момент переключаться между SQLite и MySQL с помощью команд:

```bash
npm run use-mysql   # Для использования MySQL
npm run use-sqlite  # Для использования SQLite
```

Эти команды автоматически меняют настройки в файле `.env`. 